{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/asbjborg/journal-addon/schemas/quest_context.schema.json",
  "title": "Quest context",
  "description": "Aggregated context for one quest within a session, built from quest events (accepted/turned_in). Used e.g. when passing quest info to downstream steps or LLM.",
  "type": "object",
  "required": ["questID", "title", "accepted"],
  "properties": {
    "questID": {
      "type": "integer",
      "description": "Quest ID from game data"
    },
    "title": {
      "type": "string",
      "description": "Quest title"
    },
    "accepted": {
      "type": "object",
      "description": "When and where the quest was accepted",
      "required": ["ts"],
      "properties": {
        "ts": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when accepted (ISO 8601)"
        },
        "zone": {
          "type": ["string", "null"],
          "description": "Zone at accept"
        },
        "subZone": {
          "type": ["string", "null"],
          "description": "Subzone at accept"
        }
      }
    },
    "turned_in": {
      "type": "object",
      "description": "When and where the quest was turned in. Present only when a turn-in event was recorded in the session.",
      "required": ["ts"],
      "properties": {
        "ts": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when turned in (ISO 8601)"
        },
        "zone": {
          "type": ["string", "null"],
          "description": "Zone at turn-in"
        },
        "subZone": {
          "type": ["string", "null"],
          "description": "Subzone at turn-in"
        },
        "xp": {
          "type": ["integer", "null"],
          "description": "XP reward"
        },
        "money": {
          "type": ["integer", "null"],
          "description": "Money reward (e.g. copper)"
        }
      }
    }
  }
}
